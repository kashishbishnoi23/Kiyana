<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Category Import</title>
    <link rel="stylesheet" href="../../../src/output.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
    </style>
</head>

<body>
    <div class="main p-10 w-full font-poppins">
        <!-- navbar: -->
         <hr>        
        <div class="navbar large:text-3xl  flex flex-col md:flex-row p-3 w-full justify-between  items-center">
        
            <div class="font-semibold md:mb-0">KIYANA</div>
    
            <div class="flex flex-col md:flex-row justify-between  items-center w-[80%] ">
               
                    <a href="/index.html" class="text-gray-500">Home</a>
                    <a href="/Clothing/Western/casual.html" class="text-gray-500">Clothing</a>
                    <a href="/Accessories/accessories.html" class="text-gray-500">Accessories</a>
                    <a href="/Footwear/footwear.html" class="text-gray-500">Footwear</a>
                    <a href="/cart.html" class="text-gray-500">Cart</a>
                    <a href="/AboutUs.html" class="text-gray-500">About Us</a>
                  
                
    
            
            </div>
        </div>
         <hr> 
        </div>

    <header class="bg-white shadow-sm sticky top-0 z-50 w-full">
        <nav class="container mx-auto px-4 py-4 w-full">
            <div class="flex justify-around items-center w-full">

                <!-- Navigation Links -->
                <div class="flex w-[80%]  justify-between">
                    <a href="#" id="watchNavigation" class="text-gray-600 hover:text-orange-500 transition duration-300">Watches</a>
                    <a href="#" id="capsNavigation" class="text-gray-600 hover:text-orange-500 transition duration-300">Caps</a>
                    <a href="#" id="eyewearNavigation" class="text-gray-600 hover:text-orange-500 transition duration-300">Eyewear</a>
                    <a href="#" id="handbagNavigation" class="text-gray-600 hover:text-orange-500 transition duration-300">Handbags</a>
                    <a href="#" id="jewelsNavigation" class="text-gray-600 hover:text-orange-500 transition duration-300">Jewelry</a>
                    
                </div>

            </div>
        </nav>
    </header>
    <div class=" px-10 py-5 flex w-full min-h-screen">

        <aside class="w-full min-w-[25%] md:w-64 space-y-6 mr-10">
            <div class="bg-white rounded-lg shadow-md p-6">
               
                   <!-- Price Filter -->
                   <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Price Range</h3>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between">
                            <input id="priceRangeInput" type="range" min="0" max="100" value="100"
                                class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                        </div>
                        <div class="flex justify-between text-sm text-gray-600">
                            <div class="priceRange">$1 - $100</div>
                        </div>
                    </div>
                </div>

        
                   <!-- Category Filter -->
                   <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Category</h3>
                    <div class="space-y-2 category-filter">
                    </div>
                </div>

                <!-- Rating Filter -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Rating</h3>
                    <div class="space-y-2">
                        <label class="flex items-center gap-2">
                            <input type="radio" name="rating" class="text-orange-500 focus:ring-orange-500">
                            <div class="flex text-yellow-400">
                                ★★★★★
                                <span class="text-gray-600 ml-2">& up</span>
                            </div>
                        </label>
                        <label class="flex items-center gap-2">
                            <input type="radio" name="rating" class="text-orange-500 focus:ring-orange-500">
                            <div class="flex text-yellow-400">
                                ★★★★
                                <span class="text-gray-400">★</span>
                                <span class="text-gray-600 ml-2">& up</span>
                            </div>
                        </label>
                        <label class="flex items-center gap-2">
                            <input type="radio" name="rating" class="text-orange-500 focus:ring-orange-500">
                            <div class="flex text-yellow-400">
                                ★★★
                                <span class="text-gray-400">★★</span>
                                <span class="text-gray-600 ml-2">& up</span>
                            </div>
                        </label>
                    </div>
                </div>


                <!-- Apply Filters Button -->
                <button id="applyfilters" class="w-full bg-orange-500 text-white py-2 rounded-lg hover:bg-orange-600 transition duration-300">
                    Apply Filters
                </button>
            </div>
        </aside>

        <div class="h-content products w-full gap-10  flex flex-wrap">

        </div>


    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"
    integrity="sha512-7eHRwcbYkK4d9g/6tD/mhkf++eoTHwpNM9woBxtPUBWm67zeAfFC+HrdoE2GanKeocly/VxeLvIqwvCdk7qScg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- <script type="module">
        const urlParams = new URLSearchParams(window.location.search);
        const category = urlParams.get('category'); // Get category from URL query string
        const products = document.querySelector('.products')
        console.log(products)

        console.log("category = ", category);



        // Local variable to store the imported array
        let categoryData = [];

        if (category) {
            import('./accessories.js')
                .then((module) => {
                    if (module[category]) {
                        categoryData = module[category]; // Store the data in the local variable
                        console.log('Imported Array:', categoryData); // Log the array to the console
                    } else {
                        console.log('Category not found in casuals.js');
                    }
                })
                .catch((error) => {
                    console.error('Error loading accessories.js:', error);
                });
        } else {
            document.getElementById('category-data').innerText = 'No category specified in the URL.';
            console.log('No category specified in the URL.');
        }

        function addAllProducts() {
            console.log("category data " ,categoryData)

            categoryData.forEach((item) => {
                let images = item.images;
                let colors = item.colors;
                let primary_color = colors[0];
                let brand = item.brand;
                let name = item.name;
                let price = item.price;
                let images_container = ``;

                images[primary_color].forEach((item, index) => {
                    if (index == 0) {
                        images_container += `<img style="display:inline" src="${item}" class="h-full img shadow-md w-full object-cover rounded-lg object-top" alt="">`
                    } else {
                        images_container += `<img style="display:none" src="${item}" class="h-full img shadow-md w-full object-cover rounded-lg object-top" alt="">`

                    }

                })

                console.log(products);
                products.innerHTML += `
        
        <div class="max-h-[53vh] w-[30%] t-shirts product rounded-lg flex flex-col gap-1  shadow-lg" id="${item.id}">

          <div class="h-[70%] relative w-full overflow-hidden ">

          ${images_container}
        </div>
     
         
            <div class="flex flex-col  gap-1 w-full  px-3 py-2 h-[30%]">
             <div class="brand font-semibold ">${brand}</div>
             
             <div class="text-gray-400 text-sm overflow-hidden text-nowrap text-ellipsis name ">${name}</div>
            
             <div class="price text-sm">$${price}</div>
             </div>


             

        </div>
      `


            })



            // animations on hover:
            let Allproducts = Array.from(document.querySelectorAll('.product'));

            Allproducts.forEach((item, index) => {
                let hoverTimeline = gsap.timeline({ paused: true, repeat: -1 });
                let images = Array.from(item.querySelectorAll('img'));
                images.forEach((item, index) => {

                    hoverTimeline.to(item, {
                        display: 'inline',
                        duration: 1,
                        ease: "power3.out"

                    }, index * 1);
                    hoverTimeline.to(item,
                        {
                            display: 'none',
                            duration: 1,
                            ease: "power3.out"
                        },
                        (index + 1) * 1);
                })



                item.addEventListener('mouseenter', () => {

                    hoverTimeline.play();
                    gsap.to(item, {
                        scale: 1.1,
                        duration: 0.5
                    })


                })

                item.addEventListener('mouseleave', () => {
                    hoverTimeline.pause();
                    gsap.to(images, { display: 'none', duration: 1 }); // Hide all images
                    gsap.to(images[0], { display: 'inline', duration: 1.3 }); // Show the first image smoothly
                    gsap.to(item, {
                        scale: 1,
                        duration: 0.5
                    })


                });




            })


            //  click on each product to redirect to a page that shows detailed information about the product:
            let product = document.querySelectorAll(".product");

            product.forEach((item)=>{
                item.addEventListener('click', (event)=>{
                    // store the id of the product:
                    const id = event.currentTarget.id;
                    window.location.href = `product.html?id=${id}`

                })

            })



            //  click on each product to get all the details:
            // Allproducts.forEach((product) => {

            //     product.addEventListener('click', () => {
            //         // check the index of this item:
            //         let index;
            //         tshirts.forEach((item, i) => {
            //             if (product.id === item.id) {
            //                 index = i;
            //                 console.log(index);

            //             }
            //         })

            //         console.log(index);

            //         // document.querySelector(".products_slider").classList.add(`translate-x-[${index*100}%]`);
            //         document.querySelector(".products_slider").style.transform = `translateX(-${index * 100}%)`
            //         document.querySelector(".products_slider").classList.remove('hidden');

            //     })
            // })





        }

        setTimeout(() => {
            addAllProducts();
        }, 100);

        document.querySelectorAll(".product").forEach((item) => {
            item.addEventListener('click', (event) => {
                const id = event.currentTarget.id;
                window.location.href = `product.html?id=${id}`;
            })
        })





        // document.querySelector("#priceRangeInput").addEventListener('change', (event) => {
        //     document.querySelector(".priceRange").innerHTML = `$0 - $${event.target.value}`

        // })

        // show more functionality:
        // let show_more_btns = Array.from(document.querySelectorAll(".show-more"));
        // console.log(show_more_btns);

        // show_more_btns.forEach((item) => {
        //     item.addEventListener('click', (event) => {
        //         console.log(event.currentTarget)
        //         event.currentTarget.querySelector(".up").classList.toggle('hidden');
        //         event.currentTarget.querySelector(".down").classList.toggle('hidden');

        //         // get the closest div with class dropdown:
        //         const dropdown = event.currentTarget.parentElement.parentElement.querySelector(".dropdown")
        //         dropdown.classList.toggle('hidden');
        //     })

        // })





    </script> -->


    <script type="module">
        const urlParams = new URLSearchParams(window.location.search);
        const category = urlParams.get('category'); // Get category from URL query string
        const products = document.querySelector('.products')
        console.log(products);
        console.log("category = ", category);

        let categoryArray = [];
        const object = [
            ['caps', 'glasses', 'handbags', 'jewels', 'watches']

        ]

          // Local variable to store the imported array
          let categoryData = [];
        

if (category) {
    import('./accessories.js')
        .then((module) => {
            //  this module is an object of -> key value pairs -> where keys are the  names of  exported and values are the arrays themselves
            if (module[category]) {
                categoryData = module[category]; // Store the data in the local variable
                console.log('Imported Array:', categoryData); // Log the array to the console
            } else {
                console.log('Category not found in casuals.js');
            }
        })
        .catch((error) => {
            console.error('Error loading casuals.js:', error);
        });
    }
// } else {
//     document.getElementById('category-data').innerText = 'No category specified in the URL.';
//     console.log('No category specified in the URL.');
// }

        let categoryfilter = document.querySelector(".category-filter");

        object.forEach((item) => {
            let array = item;
            console.log(array);
            array.forEach((item) => {
                if (item == category) {
                    categoryArray = array
                }
            })
        })

        categoryArray.forEach((item) => {
            let capitalized = item.charAt(0).toUpperCase() + item.slice(1);
            categoryfilter.innerHTML += `
            <label class="flex items-center gap-2">
                            <input type="radio" id=${item} name="category" class="text-pink-500 focus:ring-pink-500 categoryInput">
                            <span class="text-gray-600">${capitalized}</span>
            </label>
            `
        })

        let categoryInput = document.querySelectorAll(".categoryInput");

        categoryInput.forEach((item) => {
            if (item.id == category) {
                item.checked = true;
            }
        })

        categoryInput.forEach((item) => {
            item.addEventListener('change', (event) => {
                const id = event.currentTarget.id;
                let currentUrl = new URL(window.location.href);
                currentUrl.searchParams.set("category", id);
                window.location.href = currentUrl;
            })
        })

        let filteredprice = 100;
        document.querySelector("#priceRangeInput").addEventListener('change', (event) => {
            document.querySelector(".priceRange").innerHTML = `$1 - $${event.target.value}
        `
            filteredprice = event.target.value;
        })

        // Navigation Links:
        //  window.location is an object -> whose key href returns the current URL in form of string
        //  URL constructor converts that string into a structured object
        document.querySelector("#watchNavigation").addEventListener('click', () => {
            let currentUrl = new URL(window.location.href);
            currentUrl.searchParams.set("category", "watches");
            window.location.href = currentUrl.toString();
        })

        document.querySelector("#capsNavigation").addEventListener('click', () => {
            let currentUrl = new URL(window.location.href);
            currentUrl.searchParams.set("category", "caps");
            window.location.href = currentUrl.toString();

        })
        document.querySelector("#handbagNavigation").addEventListener('click', () => {
            let currentUrl = new URL(window.location.href);
            currentUrl.searchParams.set("category", "handbags");
            window.location.href = currentUrl.toString();
        })

        document.querySelector("#jewelsNavigation").addEventListener('click', () => {
            let currentUrl = new URL(window.location.href);
            currentUrl.searchParams.set("category", "jewels");
            window.location.href = currentUrl.toString();
        })
        document.querySelector("#eyewearNavigation").addEventListener('click', () => {
            let currentUrl = new URL(window.location.href);
            currentUrl.searchParams.set("category", "glasses");
            window.location.href = currentUrl.toString();
        })

      

        let filteredrating = 4;
        document.querySelectorAll(".ratingInput").forEach((item)=>{
            item.addEventListener('change', (event)=>{
                filteredrating = Number(event.target.id);

            })

        })

        function applyFilters() {
            
            let product = document.querySelectorAll(".product");
            product.forEach((item) => {
                let product_price = (item.querySelector(".price").textContent).replace("$", "");
                // console.log(product_price);
                // console.log(filteredprice,"<<--filtered price")
                let product_rating = item.querySelector(".rating").textContent.replace("(","");
                product_rating.replace(")", "");
                // console.log(product_rating)
                // console.log(filteredrating,"<<--filtered rating")
                if (Number(product_price) > filteredprice || Number(product_rating)  < filteredrating) {
                    item.style.display = "none";
                    console.log(item)
                } else{
                    item.style.display = "block";
                }
            }) 
        }


        function addAllProducts() {
            console.log("categoruu" , categoryData)

            categoryData.forEach((item) => {
                let images = item.images;
                let colors = item.colors;
                let primary_color = colors[0];
                let brand = item.brand;
                let name = item.name;
                let price = item.price;
                let images_container = ``;
                let rating = item.rating;
   

                images[primary_color].forEach((item, index) => {
                    if (index == 0) {
                        images_container += `<img style="display:inline" src="${item}" class="h-full img shadow-md w-full object-cover rounded-lg object-top" alt="">`
                    } else {
                        images_container += `<img style="display:none" src="${item}" class="h-full img shadow-md w-full object-cover rounded-lg object-top" alt="">`

                    }

                })

                console.log(products);
                products.innerHTML += `
        
        <div class="max-h-[53vh] w-[30%] t-shirts product rounded-lg flex flex-col gap-1  shadow-lg" id="${item.id}">

          <div class="h-[70%] relative w-full overflow-hidden ">

          ${images_container}
        </div>
     
         
            <div class="flex flex-col  gap-1 w-full  px-3 py-2 h-[30%]">
             <div class="brand font-semibold ">${brand}</div>
             
             <div class="text-gray-400 text-sm overflow-hidden text-nowrap text-ellipsis name ">${name}</div>
            
             <div class="flex gap-3 items-center justify-between">
             <div class="price text-sm">$${price}</div>
            
             
            <div class="rating text-sm "> (${rating}) </div>
        
             </div>
             

        </div>
      `


            })



            // animations on hover:
            let Allproducts = Array.from(document.querySelectorAll('.product'));

            Allproducts.forEach((item, index) => {
                let hoverTimeline = gsap.timeline({ paused: true, repeat: -1 });
                let images = Array.from(item.querySelectorAll('img'));
                images.forEach((item, index) => {

                    hoverTimeline.to(item, {
                        display: 'inline',
                        duration: 1,
                        ease: "power3.out"

                    }, index * 1);
                    hoverTimeline.to(item,
                        {
                            display: 'none',
                            duration: 1,
                            ease: "power3.out"
                        },
                        (index + 1) * 1);
                })



                item.addEventListener('mouseenter', () => {

                    hoverTimeline.play();
                    gsap.to(item, {
                        scale: 1.1,
                        duration: 0.5
                    })


                })

                item.addEventListener('mouseleave', () => {
                    hoverTimeline.pause();
                    gsap.to(images, { display: 'none', duration: 1 }); // Hide all images
                    gsap.to(images[0], { display: 'inline', duration: 1.3 }); // Show the first image smoothly
                    gsap.to(item, {
                        scale: 1,
                        duration: 0.5
                    })


                });




            })


            //  click on each product to redirect to a page that shows detailed information about the product:
            let product = document.querySelectorAll(".product");

            product.forEach((item) => {
                item.addEventListener('click', (event) => {
                    // store the id of the product:
                    const id = event.currentTarget.id;
                    window.location.href = `product.html?id=${id}`

                })

            })



            //  click on each product to get all the details:
            // Allproducts.forEach((product) => {

            //     product.addEventListener('click', () => {
            //         // check the index of this item:
            //         let index;
            //         tshirts.forEach((item, i) => {
            //             if (product.id === item.id) {
            //                 index = i;
            //                 console.log(index);

            //             }
            //         })

            //         console.log(index);

            //         // document.querySelector(".products_slider").classList.add(`translate-x-[${index*100}%]`);
            //         document.querySelector(".products_slider").style.transform = `translateX(-${index * 100}%)`
            //         document.querySelector(".products_slider").classList.remove('hidden');

            //     })
            // })





        }

        setTimeout(() => {
            addAllProducts();

        }, 50);

        document.querySelectorAll(".product").forEach((item) => {
            item.addEventListener('click', (event) => {
                const id = event.currentTarget.id;
                window.location.href = `product.html?id=${id}`;
            })
        })


document.getElementById('applyfilters').addEventListener('click',()=>{
    applyFilters()
})


        // document.querySelector("#priceRangeInput").addEventListener('change', (event) => {
        //     document.querySelector(".priceRange").innerHTML = `$0 - $${event.target.value}`
        // })

        // show more functionality:
        // let show_more_btns = Array.from(document.querySelectorAll(".show-more"));
        // console.log(show_more_btns);

        // show_more_btns.forEach((item) => {
        //     item.addEventListener('click', (event) => {
        //         console.log(event.currentTarget)
        //         event.currentTarget.querySelector(".up").classList.toggle('hidden');
        //         event.currentTarget.querySelector(".down").classList.toggle('hidden');

        //         // get the closest div with class dropdown:
        //         const dropdown = event.currentTarget.parentElement.parentElement.querySelector(".dropdown")
        //         dropdown.classList.toggle('hidden');
        //     })

        // })





    </script>
    
</body>

</html>